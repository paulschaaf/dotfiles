
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <title>6.4.&nbsp;Compiling your user script into an extension [Dive Into Greasemonkey]</title>
      <link rel="shortcut icon" href="/favicon.ico">
      <link rel="stylesheet" href="../css/dig.css" type="text/css">
      <meta http-equiv="Link" content='&lt;../css/modern.css&gt;; type="text/css"; rel=stylesheet, &lt;../css/empty.css&gt;; type="text/css";
      rel=stylesheet'>
      <link rev="made" href="mailto:mark@diveintomark.org">
      <meta name="generator" content="DocBook XSL Stylesheets V1.68.1">
      <meta name="keywords" content="Firefox, Greasemonkey, Javascript, user script, userscript">
      <link rel="start" href="../toc/index.html" title="Dive Into Greasemonkey">
      <link rel="up" href="index.html" title="Chapter&nbsp;6.&nbsp;Advanced Topics">
      <link rel="prev" href="gm_xmlhttprequest.html" title="6.3.&nbsp;Integrating data from other sites">
      <link rel="next" href="../api/index.html" title="Greasemonkey API Reference">
   </head>
   <body id="diveintogreasemonkey-org" class="advanced-compiler">
      <div class="z" id="intro">
         <div class="sectionInner">
            <div class="sectionInner2">
               <div class="s">
                  <h1><a href="/" accesskey="1">Dive Into Greasemonkey</a></h1>
                  <p>Teaching an old web new tricks</p>
               </div>
               <div class="s">
                  <ul>
                     <li><a href="../">Home</a> &middot; 
                     </li>
                     <li><a href="../toc/">Table of contents</a> &middot; 
                     </li>
                     <li><a href="../download/">Download</a> &middot; 
                     </li>
                     <li><a href="http://greasemonkey.mozdev.org/">Get Greasemonkey</a></li>
                  </ul>
               </div>
            </div>
         </div>
      </div>
      <div id="main">
         <div id="mainInner">
            <p id="breadcrumb">You are here: <a href="../">Home</a> &#8594; <a href="../toc/index.html">Table of contents</a> &#8594; <a href="index.html">Advanced Topics</a> &#8594; <span class="thispage">Compiling your user script into an extension</span></p>
            <div class="section" lang="en">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="advanced.compiler" class="skip" href="#advanced.compiler" title="link to this section"><img src="../images/permalink.gif" alt="[link]" title="link to this section" width="8" height="9"></a> 6.4.&nbsp;Compiling your user script into an extension
                        </h2>
                     </div>
                     <div>
                        <div class="abstract">
                           <h3 class="title"></h3>
                           <p>Has your user script &#8220;<span class="quote">outgrown</span>&#8221; Greasemonkey's architecture?  Does your user script need access to privileged Javascript functions, local files, or other
                              Firefox features that are only available to full-fledged browser extensions?  You can turn your user script into a full-fledged
                              <code class="filename">XPI</code> with just a few clicks, thanks to Adrian Holovaty's amazing <a href="http://www.letitblog.com/greasemonkey-compiler/">Greasemonkey compiler</a>!
                           </p>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="procedure"><a name="d0e4823" class="skip" href="#d0e4823" title="link to this procedure"><img src="../images/permalink.gif" alt="[link]" title="link to this procedure" width="8" height="9"></a> 
                  <h3 class="title">Procedure:&nbsp;Compile Butler into a browser extension</h3>
                  <ol type="1">
                     <li>
                        <p>Visit the <a href="http://diveintomark.org/projects/butler/butler.user.js">Butler user script source code</a>.  From the menu, select <span><strong class="guimenu"><span class="accel">E</span>dit</strong></span> &#8594; <span><strong class="guimenuitem">Select <span class="accel">A</span>ll</strong></span> (<span><strong class="shortcut"><span><strong class="keycap">Ctrl</strong></span>-<span><strong class="keycap">A</strong></span></strong></span>) to copy the user script's source code to the clipboard.
                        </p>
                     </li>
                     <li>
                        <p>Visit the <a href="http://www.letitblog.com/greasemonkey-compiler/">Greasemonkey compiler</a>.
                        </p>
                     </li>
                     <li>
                        <p>Go to the &#8220;<span class="guilabel">Javascript</span>&#8221; field.  From the menu, select <span><strong class="guimenu"><span class="accel">E</span>dit</strong></span> &#8594; <span><strong class="guimenuitem"><span class="accel">P</span>aste</strong></span> (<span><strong class="shortcut"><span><strong class="keycap">Ctrl</strong></span>-<span><strong class="keycap">V</strong></span></strong></span>) to paste the Butler user script source code.
                        </p>
                     </li>
                     <li>
                        <p>In the &#8220;<span class="guilabel">Creator</span>&#8221; field, enter <strong class="userinput"><code>Mark Pilgrim</code></strong>.
                        </p>
                     </li>
                     <li>
                        <p>In the &#8220;<span class="guilabel">Version</span>&#8221; field, enter the current version of the Butler user script (0.3 as of this writing, but check the script's <a href="../helloworld/metadata.html" title="2.2.&nbsp;Describing your user script with metadata">metadata section</a> for the actual version).
                        </p>
                     </li>
                     <li>
                        <p>Open a new window or tab and visit <a href="http://extensions.roachfiend.com/cgi-bin/guid.pl">GUID Generator</a> to generate a random GUID.  Copy the GUID to the clipboard, including the curly braces.
                        </p>
                     </li>
                     <li>
                        <p>Switch back to the &#8220;<span class="interface">Greasemonkey compiler</span>&#8221; page.  In the &#8220;<span class="guilabel">GUID</span>&#8221; field, paste the GUID you got from the GUID Generator.
                        </p>
                     </li>
                     <li>
                        <p>In the &#8220;<span class="guilabel">Homepage</span>&#8221; field, enter <strong class="userinput"><code><code class="systemitem">http://diveintomark.org/projects/butler/</code></code></strong>.
                        </p>
                     </li>
                     <li>
                        <p>Click <span><strong class="guibutton">Create the Firefox extension</strong></span>.  Firefox should pop up a dialog titled &#8220;<span class="interface">Opening butler.xpi</span>&#8221;.  Select <span><strong class="guibutton">Save to disk</strong></span> and select a directory.
                        </p>
                     </li>
                  </ol>
               </div>
               <p>Tada!  You now have a version of Butler as a browser extension.  Before you install the Butler extension, you should first
                  <a href="../install/manage.html#procedure.manage.userscripts" title="Procedure:&nbsp;Disable Butler temporarily">disable the Butler user script</a> and verify that it is disabled by searching for something on <a href="http://www.google.com/">Google</a>.  Then install the Butler extension by selecting <span><strong class="guimenu"><span class="accel">F</span>ile</strong></span> &#8594; <span><strong class="guimenuitem"><span class="accel">O</span>pen...</strong></span> and selecting the <code class="filename">butler.xpi</code> file you created with the Greasemonkey compiler.  Be sure to restart your browser to finish the installation.
               </p>
               <p>An <code class="filename">.xpi</code> file is really just a ZIP archive with a certain directory structure.  You can use any ZIP program (such as <a href="http://www.7-zip.org/">7-zip</a> for Windows or <a href="http://www.stuffit.com/">Stuffit Expander</a> for Mac OS X) to decompress the archive and look at the files that constitute the browser extension.
               </p>
               <div class="informalexample"><pre class="screen">butler.xpi
|
+-- install.rdf
|
+-- chrome/
    |
    +-- butler/
        |
        +-- content/
            |
            +-- browser.xul
            |
            +-- contents.rdf
            |
            +-- javascript.js</pre><p>There are four files involved.  The two RDF files are mostly Firefox boilerplate.  The other two contain the actual code.</p>
                  <div class="variablelist">
                     <dl>
                        <dt><span class="term"><code class="filename">install.rdf</code></span></dt>
                        <dd>Metadata about the extension itself, including name, version, description, and compatible versions of Firefox.</dd>
                        <dt><span class="term"><code class="filename">browser.xul</code></span></dt>
                        <dd>Bootstrap code that checks the current <acronym title="Uniform Resource Locator">URL</acronym> against the script's <code class="literal">@include</code> and <code class="literal">@exclude</code> parameters, and then injects and executes the script.
                        </dd>
                        <dt><span class="term"><code class="filename">contents.rdf</code></span></dt>
                        <dd>More metadata, Firefox boilerplate.</dd>
                        <dt><span class="term"><code class="filename">javascript.js</code></span></dt>
                        <dd>The original user script's source code.</dd>
                     </dl>
                  </div>
               </div>
               <p>Basically, the Greasemonkey compiler creates a really, really stripped down version of Greasemonkey that has no user interface
                  and automatically loads a single user script on the appropriate <acronym title="Uniform Resource Locator">URL</acronym>s.  But now you have all the source files, and you can do anything you want: create custom dialogs, modify preference panes,
                  register menu items outside the <span><strong class="guimenuitem">User Script <span class="accel">C</span>ommands</strong></span> menu... go wild!
               </p>
               <div class="furtherreading"><a href="../appendix/furtherreading.html" title="List of &#8220;further reading&#8221; links">
                     <h3>Further reading</h3></a><ul>
                     <li><a href="http://ted.mielczarek.org/code/mozilla/extensiondev/">Extension Developer's Extension</a> is invaluable for debugging and testing Firefox extensions.
                     </li>
                  </ul>
               </div>
            </div>
            <div style="float: left">&#8592;&nbsp;<a class="NavigationArrow" href="gm_xmlhttprequest.html">Integrating data from other sites</a></div>
            <div style="text-align: right"><a class="NavigationArrow" href="../api/index.html">Greasemonkey API Reference</a>&nbsp;&#8594;
            </div>
            <hr style="clear:both">
            <div class="footer">
               <p class="copyright">Copyright &copy; 2005 Mark Pilgrim &middot; <a title="send me feedback about this book" href="mailto:mark@diveintomark.org">mark@diveintomark.org</a> &middot; <a href="../license/gpl.html" title="GNU General Public License">Terms of use</a></p>
            </div>
         </div>
      </div>
   </body>
</html>