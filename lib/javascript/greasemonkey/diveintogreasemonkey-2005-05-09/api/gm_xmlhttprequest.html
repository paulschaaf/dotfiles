
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <title>GM_xmlhttpRequest [Dive Into Greasemonkey]</title>
      <link rel="shortcut icon" href="/favicon.ico">
      <link rel="stylesheet" href="../css/dig.css" type="text/css">
      <meta http-equiv="Link" content='&lt;../css/modern.css&gt;; type="text/css"; rel=stylesheet, &lt;../css/empty.css&gt;; type="text/css";
      rel=stylesheet'>
      <link rev="made" href="mailto:mark@diveintomark.org">
      <meta name="generator" content="DocBook XSL Stylesheets V1.68.1">
      <meta name="keywords" content="Firefox, Greasemonkey, Javascript, user script, userscript">
      <link rel="start" href="../toc/index.html" title="Dive Into Greasemonkey">
      <link rel="up" href="index.html" title="Greasemonkey API Reference">
      <link rel="prev" href="gm_registermenucommand.html" title="GM_registerMenuCommand">
      <link rel="next" href="../appendix/furtherreading.html" title="List of &#8220;further reading&#8221; links">
   </head>
   <body id="diveintogreasemonkey-org" class="api-gmxmlhttprequest">
      <div class="z" id="intro">
         <div class="sectionInner">
            <div class="sectionInner2">
               <div class="s">
                  <h1><a href="/" accesskey="1">Dive Into Greasemonkey</a></h1>
                  <p>Teaching an old web new tricks</p>
               </div>
               <div class="s">
                  <ul>
                     <li><a href="../">Home</a> &middot; 
                     </li>
                     <li><a href="../toc/">Table of contents</a> &middot; 
                     </li>
                     <li><a href="../download/">Download</a> &middot; 
                     </li>
                     <li><a href="http://greasemonkey.mozdev.org/">Get Greasemonkey</a></li>
                  </ul>
               </div>
            </div>
         </div>
      </div>
      <div id="main">
         <div id="mainInner">
            <p id="breadcrumb">You are here: <a href="../">Home</a> &#8594; <a href="../toc/index.html">Table of contents</a> &#8594; <a href="index.html">Greasemonkey API Reference</a> &#8594; <span class="thispage">GM_xmlhttpRequest</span></p>
            <div class="refentry" lang="en"><a name="api.gmxmlhttprequest" class="skip" href="#api.gmxmlhttprequest" title="link to this refentry"><img src="../images/permalink.gif" alt="[link]" title="link to this refentry" width="8" height="9"></a> 
               <div class="titlepage"></div>
               <div class="refnamediv">
                  <h2>Name</h2>
                  <p>GM_xmlhttpRequest &#8212; make an arbitrary <acronym title="Hypertext Transfer Protocol">HTTP</acronym> request
                  </p>
               </div>
               <div class="refsynopsisdiv">
                  <h2>Synopsis</h2>
                  <div class="funcsynopsis"><pre class="funcsynopsisinfo"></pre><p><code class="funcdef"><b class="fsfunc">GM_xmlhttpRequest</b>(</code><var class="pdparam">details</var><code>)</code>;
                     </p>
                  </div>
               </div>
               <div class="refsection" lang="en"><a name="d0e5367" class="skip" href="#d0e5367" title="link to this refsection"><img src="../images/permalink.gif" alt="[link]" title="link to this refsection" width="8" height="9"></a> 
                  
                  <h2>Description</h2>
                  
                  <p><code class="function">GM_xmlhttpRequest</code> makes an arbitrary <acronym title="Hypertext Transfer Protocol">HTTP</acronym> request.  The <em class="parameter"><code>details</code></em> argument is an object that can contain up to seven fields.
                  </p>
                  
                  <div class="variablelist">
                     <dl>
                        <dt><span class="term">method</span></dt>
                        <dd>a string, the <acronym title="Hypertext Transfer Protocol">HTTP</acronym> method to use on this request.  <span class="emphasis"><em>Required.</em></span>  Generally <code class="constant">GET</code>, but can be any <acronym title="Hypertext Transfer Protocol">HTTP</acronym> verb, including <code class="literal">POST</code>, <code class="literal">PUT</code>, and <code class="literal">DELETE</code>.
                        </dd>
                        <dt><span class="term">url</span></dt>
                        <dd>a string, the <acronym title="Uniform Resource Locator">URL</acronym> to use on this request.  <span class="emphasis"><em>Required.</em></span></dd>
                        <dt><span class="term">headers</span></dt>
                        <dd>an associative array of <acronym title="Hypertext Transfer Protocol">HTTP</acronym> headers to include on this request.  Optional, defaults to an empty array.  Example:
                           <div class="informalexample"><pre class="programlisting ">headers: {'User-Agent': 'Mozilla/4.0 (compatible) Greasemonkey',
          'Accept': 'application/atom+xml,application/xml,text/xml'}</pre></div>
                        </dd>
                        <dt><span class="term">data</span></dt>
                        <dd>a string, the body of the <acronym title="Hypertext Transfer Protocol">HTTP</acronym> request.  Optional, defaults to an empty string.  If you are simulating posting a form (<em class="parameter"><code>method</code></em> == <code class="literal">'POST'</code>), you must include a <code class="literal">Content-type</code> of <code class="literal">'application/x-www-form-urlencoded'</code> in the <em class="parameter"><code>headers</code></em> field, and include the <acronym title="Uniform Resource Locator">URL</acronym>-encoded form data in the <em class="parameter"><code>data</code></em> field.
                        </dd>
                        <dt><span class="term"><code class="systemitem">onload</code></span></dt>
                        <dd>a function object, the callback function to be called when the request has finished successfully.</dd>
                        <dt><span class="term"><code class="systemitem">onerror</code></span></dt>
                        <dd>a function object, the callback function to be called if an error occurs while processing the request.</dd>
                        <dt><span class="term"><code class="systemitem">onreadystatechange</code></span></dt>
                        <dd>a function object, the callback function to be called repeatedly while the request is in progress.</dd>
                     </dl>
                  </div>
                  
                  
                  <div class="refsection" lang="en"><a name="d0e5486" class="skip" href="#d0e5486" title="link to this refsection"><img src="../images/permalink.gif" alt="[link]" title="link to this refsection" width="8" height="9"></a> 
                     
                     <h3><code class="systemitem">onload</code> callback
                     </h3>
                     
                     <p>The callback function for <code class="systemitem">onload</code> takes a single parameter, <em class="parameter"><code>responseDetails</code></em>.
                     </p>
                     
                     <div class="funcsynopsis"><pre class="funcsynopsisinfo"></pre><p><code class="funcdef">function <b class="fsfunc">onloadCallback</b>(</code><var class="pdparam">responseDetails</var><code>)</code>;
                        </p>
                     </div>
                     
                     <p><em class="parameter"><code>responseDetails</code></em> is an object with five fields.
                     </p>
                     
                     <div class="variablelist">
                        <dl>
                           <dt><span class="term">status</span></dt>
                           <dd>an integer, the <acronym title="Hypertext Transfer Protocol">HTTP</acronym> status code of the response.  <code class="constant">200</code> means the request completed normally.
                           </dd>
                           <dt><span class="term">statusText</span></dt>
                           <dd>a string, the <acronym title="Hypertext Transfer Protocol">HTTP</acronym> status text.  Status text is server-dependent.
                           </dd>
                           <dt><span class="term">responseHeaders</span></dt>
                           <dd>a string, the <acronym title="Hypertext Transfer Protocol">HTTP</acronym> headers included in the response.
                           </dd>
                           <dt><span class="term">responseText</span></dt>
                           <dd>a string, the body of the response.</dd>
                           <dt><span class="term">readyState</span></dt>
                           <dd>unused</dd>
                        </dl>
                     </div>
                     
                  </div>
                  
                  
                  <div class="refsection" lang="en"><a name="d0e5563" class="skip" href="#d0e5563" title="link to this refsection"><img src="../images/permalink.gif" alt="[link]" title="link to this refsection" width="8" height="9"></a> 
                     
                     <h3><code class="systemitem">onerror</code> callback
                     </h3>
                     
                     <p>The callback function for <code class="systemitem">onerror</code> takes a single parameter, <em class="parameter"><code>responseDetails</code></em>.
                     </p>
                     
                     <div class="funcsynopsis"><pre class="funcsynopsisinfo"></pre><p><code class="funcdef">function <b class="fsfunc">onerrorCallback</b>(</code><var class="pdparam">responseDetails</var><code>)</code>;
                        </p>
                     </div>
                     
                     <p><em class="parameter"><code>responseDetails</code></em> is an object with five fields.
                     </p>
                     
                     <div class="variablelist">
                        <dl>
                           <dt><span class="term">status</span></dt>
                           <dd>an integer, the <acronym title="Hypertext Transfer Protocol">HTTP</acronym> error code of the response.  <code class="constant">404</code> means the page was not found.
                           </dd>
                           <dt><span class="term">statusText</span></dt>
                           <dd>a string, the <acronym title="Hypertext Transfer Protocol">HTTP</acronym> status text.  Status text is server-dependent.
                           </dd>
                           <dt><span class="term">responseHeaders</span></dt>
                           <dd>a string, the <acronym title="Hypertext Transfer Protocol">HTTP</acronym> headers included in the response.
                           </dd>
                           <dt><span class="term">responseText</span></dt>
                           <dd>a string, the body of the response.  The body of an <acronym title="Hypertext Transfer Protocol">HTTP</acronym> error page is server-dependent.
                           </dd>
                           <dt><span class="term">readyState</span></dt>
                           <dd>unused</dd>
                        </dl>
                     </div>
                     
                     
                  </div>
                  
                  
                  <div class="refsection" lang="en"><a name="d0e5644" class="skip" href="#d0e5644" title="link to this refsection"><img src="../images/permalink.gif" alt="[link]" title="link to this refsection" width="8" height="9"></a> 
                     
                     <h3><code class="systemitem">onreadystatechange</code> callback
                     </h3>
                     
                     <p>The callback function for <code class="systemitem">onreadystatechange</code> is called repeatedly while the request is in progress.  It takes a single parameter, <em class="parameter"><code>responseDetails</code></em>.
                     </p>
                     
                     <div class="funcsynopsis"><pre class="funcsynopsisinfo"></pre><table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0">
                           <tr>
                              <td><code class="funcdef">function <b class="fsfunc">onreadystatechangeCallback</b>(</code></td>
                              <td>&nbsp;</td>
                              <td><var class="pdparam">responseDetails</var><code>)</code>;
                              </td>
                           </tr>
                        </table>
                     </div>
                     
                     <p><em class="parameter"><code>responseDetails</code></em> is an object with five fields.  The <code class="property">responseDetails.readyState</code> denotes what stage the request is currently in.
                     </p>
                     
                     <div class="variablelist">
                        <dl>
                           <dt><span class="term">status</span></dt>
                           <dd>an integer, the <acronym title="Hypertext Transfer Protocol">HTTP</acronym> status code of the response.  This will be <code class="constant">0</code> when <code class="property">responseDetails.readyState</code> <code class="literal">&lt;</code> <code class="constant">4</code>.
                           </dd>
                           <dt><span class="term">statusText</span></dt>
                           <dd>a string, the <acronym title="Hypertext Transfer Protocol">HTTP</acronym> status text.  This will be an empty string when <code class="property">responseDetails.readyState</code> <code class="literal">&lt;</code> <code class="constant">4</code>.
                           </dd>
                           <dt><span class="term">responseHeaders</span></dt>
                           <dd>a string, the <acronym title="Hypertext Transfer Protocol">HTTP</acronym> headers included in the response.  This will be an empty string when <code class="property">responseDetails.readyState</code> <code class="literal">&lt;</code> <code class="constant">4</code>.
                           </dd>
                           <dt><span class="term">responseText</span></dt>
                           <dd>a string, the body of the response.  This will be an empty string when <code class="property">responseDetails.readyState</code> <code class="literal">&lt;</code> <code class="constant">4</code>.
                           </dd>
                           <dt><span class="term">readyState</span></dt>
                           <dd>an integer, the stage of the <acronym title="Hypertext Transfer Protocol">HTTP</acronym> request.
                              <div class="variablelist">
                                 <dl>
                                    <dt><span class="term"><code class="constant">1</code></span></dt>
                                    <dd>loading.  The request is being prepared.</dd>
                                    <dt><span class="term"><code class="constant">2</code></span></dt>
                                    <dd>loaded.  The request is ready to be sent to the server, but nothing has been sent yet.</dd>
                                    <dt><span class="term"><code class="constant">3</code></span></dt>
                                    <dd>interactive.  The request has been sent and the client is waiting for the server to finish sending data.</dd>
                                    <dt><span class="term"><code class="constant">4</code></span></dt>
                                    <dd>complete.  The request is completed and all response data is available in other fields.</dd>
                                 </dl>
                              </div>
                           </dd>
                        </dl>
                     </div>
                     
                  </div>
                  
                  
               </div>
               <div class="refsection" lang="en"><a name="d0e5792" class="skip" href="#d0e5792" title="link to this refsection"><img src="../images/permalink.gif" alt="[link]" title="link to this refsection" width="8" height="9"></a> 
                  
                  <h2>Examples</h2>
                  
                  <p>The following code fetches the Atom feed from <a href="http://greaseblog.blogspot.com/">http://greaseblog.blogspot.com/</a> and displays an alert with the results.
                  </p>
                  
                  <div class="informalexample"><pre class="programlisting ">GM_xmlhttpRequest({
    method: 'GET',
    url: 'http://greaseblog.blogspot.com/atom.xml',
    headers: {
        'User-agent': 'Mozilla/4.0 (compatible) Greasemonkey',
        'Accept': 'application/atom+xml,application/xml,text/xml',
    },
    onload: function(responseDetails) {
        alert('Request for Atom feed returned ' + responseDetails.status +
              ' ' + responseDetails.statusText + '\n\n' +
              'Feed data:\n' + responseDetails.responseText);
    }
});</pre></div>
                  
               </div>
               <div class="refsection" lang="en"><a name="d0e5806" class="skip" href="#d0e5806" title="link to this refsection"><img src="../images/permalink.gif" alt="[link]" title="link to this refsection" width="8" height="9"></a> 
                  
                  <h2>Bugs</h2>
                  
                  <p>The <code class="systemitem">onreadystatechange</code> callback does not work properly with <code class="property">readyState</code> <code class="literal">&lt;</code> <code class="constant">4</code>.
                  </p>
                  
               </div>
               <div class="refsection" lang="en"><a name="d0e5826" class="skip" href="#d0e5826" title="link to this refsection"><img src="../images/permalink.gif" alt="[link]" title="link to this refsection" width="8" height="9"></a> 
                  
                  <h2>Notes</h2>
                  
                  <p>Unlike the <code class="classname">XMLHttpRequest</code> object, <code class="function">GM_xmlhttpRequest</code> is not restricted to the current domain; it can <code class="constant">GET</code> or <code class="constant">POST</code> data from any <acronym title="Uniform Resource Locator">URL</acronym>.
                  </p>
                  
               </div>
               <div class="refsection" lang="en"><a name="d0e5849" class="skip" href="#d0e5849" title="link to this refsection"><img src="../images/permalink.gif" alt="[link]" title="link to this refsection" width="8" height="9"></a> 
                  
                  <h2>History</h2>
                  
                  <p><code class="function">GM_xmlhttpRequest</code> was introduced in Greasemonkey 0.2.6.
                  </p>
                  
                  <div class="furtherreading"><a href="../appendix/furtherreading.html" title="List of &#8220;further reading&#8221; links">
                        <h3>Futher reading</h3></a><ul>
                        <li><a href="http://www.xulplanet.com/references/objref/XMLHttpRequest.html"><code class="classname">XMLHttpRequest</code> support in Mozilla</a></li>
                        <li><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/xmlsdk/html/xmobjpmexmlhttprequest.asp"><code class="classname">XMLHttpRequest</code> support in Internet Explorer</a></li>
                        <li><a href="http://developer.apple.com/internet/webcontent/xmlhttpreq.html"><code class="classname">XMLHttpRequest</code> support in Safari</a></li>
                        <li><a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html"><acronym title="Hypertext Transfer Protocol">HTTP</acronym> status codes</a></li>
                        <li><a href="http://www.w3.org/Protocols/rfc2616/rfc2616.html">RFC 2616</a></li>
                     </ul>
                  </div>
                  
               </div>
            </div>
            <div style="float: left">&#8592;&nbsp;<a class="NavigationArrow" href="gm_registermenucommand.html">GM_registerMenuCommand</a></div>
            <div style="text-align: right"><a class="NavigationArrow" href="../appendix/furtherreading.html">List of &#8220;further reading&#8221; links</a>&nbsp;&#8594;
            </div>
            <hr style="clear:both">
            <div class="footer">
               <p class="copyright">Copyright &copy; 2005 Mark Pilgrim &middot; <a title="send me feedback about this book" href="mailto:mark@diveintomark.org">mark@diveintomark.org</a> &middot; <a href="../license/gpl.html" title="GNU General Public License">Terms of use</a></p>
            </div>
         </div>
      </div>
   </body>
</html>