<?xml version="1.0" ?>

<project
   name="CC403 PGS Login"
   default="! manual"
   basedir=".">
   <description>
      Quick logins for a Guidewire application by Paul Schaaf 08/13/07
   </description>

   <import file="../edu-macros.xml"/>


	<!-- =========================================================
		==
		==  Login Macro
		==
		=========================================================== -->

	<macrodef name="login">
		<attribute
			name="browser"
			default="${browser.gw-app}" />
		<attribute
			name="entrypoint"
			default="Login" />
		<attribute
			name="user"
			default="" />
		<attribute
			name="password"
			default="${default.password}" />
		<attribute
			name="args"
			default="" />

		<sequential>
			<condition
				property="credentials"
				value="">
				<equals
					arg1="@{user}"
					arg2="" />
			</condition>
			<property
				name="credentials"
				value="?loginPassword=@{password}&amp;loginName=@{user}" />

			<condition
				property="args"
				value="">
				<equals
					arg1="@{args}"
					arg2="" />
			</condition>
			<condition
				property="args"
				value="?@{args}">
				<equals
					arg1="${credentials}"
					arg2="" />
			</condition>
			<property
				name="args"
				value="&amp;@{args}" />

			<browse
				browser="@{browser}"
				url="${application.url}/@{entrypoint}.do${credentials}${args}" />

			<!-- IE doesn't handle repeated calls well without a delay. The delay has no 
				effect on a single call as it occurs after the user receives control. -->
			<sleep milliseconds="750" />
		</sequential>
	</macrodef>


	<!-- =========================================================
		==
		==  Default logins
		==
		=========================================================== -->

   <target
      name="! InternalTools"
      description="">
      <!-- Use this target as a template and supply credentials to go *directly* to
         any EntryPoint that requires authentication (see EntryPoints.pcf). I didn't
         include any others here since they are all reachable through InternalTools.
      -->
      <login entrypoint="InternalTools" user="su" />
   </target>

   <target
      name="! Reload PCFs"
      description="">
      <ant
      	antfile="../build-cc.xml"
      	target="quick-copy-config" />
      <login entrypoint="ReloadPCFs_Ext" />
   </target>

   <target
      name="! su"
      description="">
      <login user="${server.user}" />
   </target>

   <target
      name="! admin"
      description="">
      <login user="admin" />
   </target>

   <target
      name="! manual"
      description="">
      <login />
   </target>

	<!--
   <target
      name="! ClaimSummaryTemplate"
      description="">
      <login
      	entrypoint="ClaimSummaryTemplate"
      	user="aapplegate" 
      	args="claimNumber=235-53-365870" />
   </target>
	-->

   <target
      name="! ClaimLossDetails"
      description="">
      <login
      	entrypoint="ExternalLink"
      	user="aapplegate" 
      	args="linkName=ClaimLossDetailsByNumber&amp;claimNumber=235-53-365870" />
   </target>


	<!-- =========================================================
		==
		==  Group Logins
		==
      ==  Use <antcall> to name each login (instead of a depends attribute) 
      ==  so that the Eclipse Ant task will list each login as a subtask.
		==
		=========================================================== -->

   <target
      name="@ Comp - TeamA"
      description="Login as several users in this group">
      <antcall target="wmotley" />
      <antcall target="gickes" />
   </target>

   <target
      name="@ Midwest Property A"
      description="Login as several users in this group">
      <antcall target="carcle" />
      <antcall target="rbarnes" />
   </target>

   <target
      name="@ Western Auto"
      description="Login as several users in this group">
      <antcall target="aapplegate" />
      <antcall target="mmaples" />
      <antcall target="ssmith" />
   </target>


	<!-- =========================================================
		==
		==  Individual Logins
		==
		=========================================================== -->

   <target
      name="aapplegate"
      description="">
      <login user="aapplegate" />
   </target>

   <target
      name="carcle"
      description="">
      <login user="carcle" />
   </target>

   <target
      name="gickes"
      description="">
      <login user="gickes" />
   </target>

   <target
      name="mmaples"
      description="">
      <login user="mmaples" />
   </target>

   <target
      name="rbarnes"
      description="">
      <login user="rbarnes" />
   </target>

   <target
      name="ssmith"
      description="">
      <login user="ssmith" />
   </target>

   <target
      name="wmotley"
      description="">
      <login user="wmotley" />
   </target>

</project>