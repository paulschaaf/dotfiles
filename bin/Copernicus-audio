#!/bin/zsh

if [[ `hostname` = "copernicus" ]]; then
  (( $# )) && playerctl -p strawberry "${@}" # exec command

  alias notify-send='notify-send -a'
  RESPONSE=$(playerctl -p strawberry metadata --format 'artist="{{xesam:artist}}"; title="{{xesam:title}}"; album="{{xesam:album}}"; track="{{xesam:trackNumber}}"; year="{{year}}"; playStatus="{{lc(status)}}"; position="{{duration(position)}}"; length="{{duration(mpris:length)}}"')
else
  RESPONSE=$(ssh -xv copernicus ${(F)0:t} "${@}" || echo "title='Network Error'; artist='No response from Copernicus'")
  echo $?
fi

echo $RESPONSE
eval $RESPONSE
# shellcheck disable=SC2154 # var referenced but not assigned
notify-send "$title" "$artist
\"$album\" ($year) track $track
$playStatus at $position / $length"