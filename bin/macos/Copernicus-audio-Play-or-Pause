#!/bin/zsh

FMT="from {{xesam:album}} ({{year}} {{xesam:genre}})
{{emoji(status)}} @ {{duration(position)}}/{{duration(mpris:length)}}@@@{{xesam:artist}}, \"{{xesam:title}}\""

CMD="playerctl play-pause && playerctl metadata --format ${(q)FMT}"

if [ "$1" = "-d" ]; then
   echo $CMD
   typeset CMD
fi

RESPONSE=$(ssh -x copernicus ${CMD})
title=${RESPONSE##*@@@}
info=${RESPONSE%%@@@*}
#typeset -p RESPONSE title info
echo ${title}
echo ${info}
notify-send ${info} ${title}

