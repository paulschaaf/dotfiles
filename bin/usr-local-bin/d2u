#!/bin/sh

dos=ibmpc
mac=macintosh
unix=latin1

cmd=`basename $0`

convert () {
    recode -f $from..$to "$*"
}

case $cmd in
    d2u)
        convert () {
            for x
            do
                temp=`mktemp $$.XXXXXX` || exit 1
                tr -d '\015' < $x > $temp
                mv -f $temp $x
            done
        }
        ;;
    d2*)
        from=$dos
        ;;
    m2*)
        from=$mac
        ;;
    u2*)
        from=$unix
        ;;
    *)
        echo Error: invalid 'from' case in $0
        ;;
esac
case $cmd in
    *2d)
        to=$dos
        ;;
    *2m)
        to=$mac
        ;;
    *2u)
        to=$unix
        ;;
    *)
        echo Error: invalid 'to' case in $0
        ;;
esac

case $1 in
    -h|--help)
        echo Usage: $cmd FILE...
        echo Convert file\(s\) from \'$from\' format to \'$to\' format.
        echo '  --synonyms  'Display alternate names for this application.
        exit
        ;;

    --synonyms)
        for from in d m u
        do
            for to in d m u
            do
                if [ "$from" != "$to" ]
                then
                    synonym=${from}2${to}
                    if [ "$synonym" != "$cmd" ]
                    then
                        echo $synonym
                    fi
                fi
            done
        done
        exit
        ;;

    *)
        ;;
esac

convert $*